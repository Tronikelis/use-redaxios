"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react"),r=require("redaxios"),a=require("merge-anything"),s=require("fast-json-stable-stringify"),o=require("tiny-lru");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(r),u=n(s),l=n(o);const d={axios:i.default.defaults},c=t.createContext({options:d});const p=({...e})=>((e,t=0)=>{let r=3735928559^t,a=1103547991^t;for(let t,s=0;s<e.length;s++)t=e.charCodeAt(s),r=Math.imul(r^t,2654435761),a=Math.imul(a^t,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&a)+(r>>>0)})(u.default({...e})).toString(),f=l.default(500,36e5);function v(e,r={},s){const{options:o}=t.useContext(c),[n,l]=t.useState(f.get(p({url:e,relativeUrl:"",type:"get",options:r,deps:s}))),[d,v]=t.useState(!!s),[y,h]=t.useState(!!s),[g,x]=t.useState(void 0),b=async(t,n,d)=>{var c;h(!0);const y=f.get(p({url:e,relativeUrl:n,type:t,body:d,options:r,deps:s}));y?(l(y),v(!1)):v(!0);const g=a.merge(o,r);g.axios=await(e=>{var t;return(null===(t=g.interceptors)||void 0===t?void 0:t.request)?g.interceptors.request(e):e})(null!==(c=g.axios)&&void 0!==c?c:{});const[b,m]=await async function(e){try{return[await e,!1]}catch(e){return[e,!0]}}(i.default({url:e+n,method:t,data:d,...g.axios}));return m?(x(b),q=b,g.onError&&g.onError(q),h(!1),void v(!1)):(b.data=await(e=>{var t;return(null===(t=g.interceptors)||void 0===t?void 0:t.response)?g.interceptors.response(e):e})(b.data),C=b.data,M=y,u.default(C)!==u.default(M)&&(f.set(p({url:e,relativeUrl:n,type:t,body:d,options:r,deps:s}),b.data),l(b.data)),x(void 0),(e=>{g.onSuccess&&g.onSuccess(e)})(b.data),h(!1),v(!1),b.data);var q,C,M};t.useEffect((()=>{Array.isArray(s)&&b("get","")}),[u.default(s)]);const m=t.useCallback((async(e="")=>b("get",e)),[e]),q=t.useCallback((async(e="",t)=>b("post",e,t)),[e]),C=t.useCallback((async(e="")=>b("delete",e)),[e]),M=t.useCallback((async(e="",t)=>b("put",e,t)),[e]),S=t.useCallback((async(e="",t)=>b("patch",e,t)),[e]);return{data:n,error:g,fetching:y,loading:d,get:m,post:q,del:C,put:M,patch:S}}exports.RedaxiosProvider=function({options:t,children:r}){return e.jsx(c.Provider,Object.assign({value:{options:t}},{children:r}),void 0)},exports.default=v,exports.useRedaxios=v;
